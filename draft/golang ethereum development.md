## install solc-select

参考我这篇文章[solidity 版本管理工具 solc-select 介绍](https://liushiming.cn/article/solidity-version-manager-solc-select-introduction.html)

## install geth & tools

在这里找到最新的稳定版 geth & toools。geth 是以太坊客户端，tools 是周边开发工具。

![](https://cdn.liushiming.cn/img/20201112113957.png)

```bash
wget https://gethstore.blob.core.windows.net/builds/geth-alltools-linux-amd64-1.9.23-8c2f2715.tar.gz
```

将下载的 tar.gz 文件解压到 `/usr/local/bin` 目录下，里面全部是打包好的可执行文件(除了 COPYING 这个文件，这是授权说明)。

```bash
tar xvzf geth-alltools-linux-amd64-1.9.23-8c2f2715.tar.gz
cd geth-alltools-linux-amd64-1.9.23-8c2f2715
mv * /usr/local/bin && rm /usr/local/bin/COPYING
```

验证安装

```bash
geth -v
abigen -v
```

## abigen

帮助文件

```text
abigen --help
abigen [global options] command [command options] [arguments...]

VERSION:
   1.9.23-stable-8c2f2715

COMMANDS:
   help                               Shows a list of commands or help for one command

GLOBAL OPTIONS:
   --abi value                        Path to the Ethereum contract ABI json to bind, - for STDIN
   --bin value                        Path to the Ethereum contract bytecode (generate deploy method)
   --type value                       Struct name for the binding (default = package name)
   --combined-json value              Path to the combined-json file generated by compiler
   --sol value                        Path to the Ethereum contract Solidity source to build and bind
   --solc value                       Solidity compiler to use if source builds are requested (default: "solc")
   --vy value                         Path to the Ethereum contract Vyper source to build and bind
   --vyper value                      Vyper compiler to use if source builds are requested (default: "vyper")
   --exc value                        Comma separated types to exclude from binding
   --pkg value                        Package name to generate the binding into
   --out value                        Output file for the generated binding (default = stdout)
   --lang value                       Destination language for the bindings (go, java, objc) (default: "go")
   --alias value                      Comma separated aliases for function and event renaming, e.g. foo=bar
   --help, -h                         show help
   --version, -v                      print the version
```

## 生成与合约交互的 go 代码

根据合约生成 bin 文件

```bash
$ solc --bin StakingRewards.sol -o out
Compiler run successful. Artifact(s) can be found in directory out.
$ cd out/
$ ls
Address.bin        IERC20.bin           IUniswapV2ERC20.bin  ReentrancyGuard.bin               SafeERC20.bin  StakingRewards.bin
ERC20Detailed.bin  IStakingRewards.bin  Math.bin             RewardsDistributionRecipient.bin  SafeMath.bin
```

根据合约生成 abi 文件

```bash
$ solc --abi StakingRewards.sol -o out
Compiler run successful. Artifact(s) can be found in directory out.
$ ~/contract# cd out/
$ ~/contract/out# ls
Address.abi        ERC20Detailed.bin  IStakingRewards.abi  IUniswapV2ERC20.bin  ReentrancyGuard.abi               RewardsDistributionRecipient.bin  SafeMath.abi        StakingRewards.bin
Address.bin        IERC20.abi         IStakingRewards.bin  Math.abi             ReentrancyGuard.bin               SafeERC20.abi                     SafeMath.bin
ERC20Detailed.abi  IERC20.bin         IUniswapV2ERC20.abi  Math.bin             RewardsDistributionRecipient.abi  SafeERC20.bin                     StakingRewards.abi
```

根据 bin 文件和 abi 文件生成合约 go 代码

```bash
abigen --abi StakingRewards.abi --bin StakingRewards.bin --pkg=stakingrewards > stakingRewards.go
```

将生成的 go 文件放到 golang 项目中对应的 package 下。

##
